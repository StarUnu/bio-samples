# A COMPARISON OF KAMERIS AND CASTOR-KRFE
Author: MSc. Vicente Machaca Arceda

Online version for testing Kameris algorithm and see the CGR: http://134.209.44.160/viral/viral.html

Kameris and Castor-KRFE are methods based on k-mer frequencies for viral subtypying classification. Kameris was proposed by Solis-Reyes et al. (2018), they compute the k-mer frequencies using a Frequency Chaos Game Representation (FCGR) meanwhile Castor-KRFE,
proposed by Lebatteux, Remita, and Diallo (2019), compute the k-mer frequencies from the whole training datasets.

# Files and folders descriptión:
- chaos_game.- Compute the CGR of a viral genome. The implementation is in Javascript.
- sample_genomes.- Some genome samples of HIV-1 and Polyomavirus.
- results.- Here, there are CSVs and images computed with the comparison of Kameris and Castor-KRFE.
- feature_extractor.py.- Implementation of Castor-KRFE [1].
- mykameris.py.- Implementation of Kameris [2]. The implementation is in cgr() function.
- compare.py.- This script divides the dataset and train with Kameris and Castor-KRFE. It generates CSVs files.
- graphics.py.- This script takes the CSVs generated by compare.py and plot the results.
- train.py.- This script trains the datasets with all samples and saves the models.
- test.py.- This script evaluates a sample genome and reTurn its virus subtype.

# Requeriments
- Python==3.6.3 
- numpy==1.11.0
- matplotlib==3.0.3
- kameris==1.2.3 (only used for the comparison of kameris's real implementation and Kameris's own implementation)
- kameris_formats==1.0.6 (only used for the comparison of kameris's real implementation and Kameris's own implementation)
- iteration_utilities==0.10.1
- pandas==0.24.2
- tqdm==4.43.0
- seaborn==0.9.1
- Bio==0.1.0
- scikit_learn==0.22.2.post1

# Training
First download the datasets from: https://drive.google.com/drive/folders/17xcPSTebwBriZCxhTA26fHF098AY0H7k?usp=sharing.

The compare.py script executes 5-fold validation and compares the performance of Kameris and Castor-KRFE in terms of accuracy, precision, recall, f-score and number of features. All of them for different k-mers (ranging from 1 to 9). The compare.py script will generate CSVs files named for example: "HIVGRPCG_dr=0_nfeatures.csv" this file correspond to HIVGRPCG dataset without dimensionality reduction. Also, the file "POLSPELT_dr=1_nfeatures" corresponds to the POLSPELT dataset with dimensionality reduction. For running: 

- compare.py  $path_to_dataset  $virus_type  $dimentionality_reduction 

For example in my case is:

- compare.py "/home/vicente/projects/BIOINFORMATICS/datasets/VIRAL/"  HIV  1

If we need a comparison without dimentionality reduction:

- compare.py "/home/vicente/projects/BIOINFORMATICS/datasets/VIRAL/"  HIV  0

The $virus_type could be:
- POL
- HIV
- DENGE

The $dimentionality_reduction could be:
- 0
- 1

Also, you could run train.py in order to train the datasets with all samples, the models are saved in /models/ directory. We save a model for each dataset.

- train.py $path_to_dataset $virus_type $dimentionality_reduction

# Testing

For testing, there is a script test.py that receives a Fasta file and a model as parameters and returns the virus subtype:

- test.py  $fasta_file  $model

$fasta_file is the full path to a sequence in Fasta format. The $model could be:
- POLSPEVP1, POLSPEVP2, POLSPEVP3, POLSPEST, POLSPELT
- HIVGRPCG, HIVSUBCG, HIVSUBPOL

The $model is associated with the models save in train.py, for each dataset we save a model.

Moreover, an online version of test.py is here: http://134.209.44.160/viral/viral.html. In a similar way to the script, you need to send a Fasta file and choose an appropriate model. Also, the Chaos Game Representation of the genome is presented.

# References

[1] Lebatteux, D., A. M. Remita, and A. B. Diallo. 2019. “Toward an alignment-free method for feature extraction
and accurate classification of viral sequences.” Journal of Computational Biology 26 (6): 519–535.

[2] Solis-Reyes, S., M. Avino, A. Poon, and L. Kari. 2018. “An open-source k-mer based machine learning tool for
fast and accurate subtyping of HIV-1 genomes.” PloS one 13 (11).
